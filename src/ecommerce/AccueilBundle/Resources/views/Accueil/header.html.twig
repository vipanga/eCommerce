{# src/ecommerce/AccueilBundle/Resources/views/Accueil/header.html.twig #}

<!-- Header Top -->
<section class="header-top">
    <div class="container">
        <div class="row">
            <div class="header-top-left form-inline col-sm-6 compact-hidden">
                <div class="curr">
                    <div class="form-group currencies-block">
                        <form action="#"
                              method="post" enctype="multipart/form-data" id="currency">
                            <a class="btn btn-xs dropdown-toggle" data-toggle="dropdown">
                                <span class="icon icon-credit "></span>
                                US Dollar <span class="fa fa-angle-down"></span>
                            </a>
                            <ul class="dropdown-menu btn-xs">
                                <li>
                                    <a title="Pounds">(FC)
                                        &nbsp;Franc C. </a>
                                </li>
                                <li>
                                    <a title="US Dollar">($)
                                        &nbsp;US Dollar </a>
                                </li>
                            </ul>
                            <input name="code" value="" type="hidden">
                            <input name="redirect"
                                   value="#"
                                   type="hidden">
                        </form>
                    </div>


                </div>

                <div class="lang">
                    <div class="form-group languages-block ">
                        <form action="#" method="post" id="bt-language">
                            <a class="btn btn-xs dropdown-toggle" data-toggle="dropdown">
                                <img src="{{ asset('img/fr.png') }}"
                                     alt="Français" title="Français">
                                <span>Français</span>
                                <span class="fa fa-angle-down"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a>
                                        <img class="image_flag"
                                             src="{{ asset('img/fr.png') }}"
                                             alt="Français" title="Français">
                                        Français </a>
                                </li>
                                <li>
                                    <a>
                                        <img class="image_flag"
                                             src="{{ asset('img/gb.png') }}"
                                             alt="English" title="English">
                                        English
                                    </a>
                                </li>
                            </ul>

                            <input name="code" value="" type="hidden">
                            <input name="redirect"
                                   value="#"
                                   type="hidden">
                        </form>
                    </div>


                </div>

            </div>
            <div class="header-top-right collapsed-block col-xs-6 compact-hidden">
                <h5 class="tabBlockTitle visible-sm visible-xs">More<a class="expander " href="#TabBlock-1"><i
                                class="fa fa-angle-down"></i></a></h5>
                <div class="tabBlock" id="TabBlock-1">

                    <ul class="top-link list-inline">
                        {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                            <li class="account" id="my_account">
                                <a href="{{ path('fos_user_profile_show') }}" title="{{ app.user.username }}"
                                   class="btn btn-xs dropdown-toggle ">
                                    <span>{{ app.user.username }}</span>
                                </a>
                            </li>
                            <li class="checkout">
                                <a href="{{ path('ecommerce_article_publications') }}" class="top-link-checkout"
                                   title="Checkout">
                                    <span>Mes Produits</span>
                                </a>
                            </li>
                            <li class="checkout">
                                <a href="{{ path('fos_user_security_logout') }}" class="top-link-checkout"
                                   title="Checkout">
                                    <span>Déconnexion</span>
                                </a>
                            </li>
                        {% else %}
                            <li class="checkout">
                                <a href="{{ path('fos_user_security_login') }}" class="top-link-checkout"
                                   title="Checkout">
                                    <span>Se connecter</span>
                                </a>
                            </li>
                            <li class="checkout">
                                <a href="{{ path('fos_user_registration_register') }}" class="top-link-checkout"
                                   title="Checkout">
                                    <span>S'inscrire</span>
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- container for top line of header -->


<section class="header-center left">
    <div class="container">
        <div class="row">
            <!--header variant center-->
            <!-- Logo -->
            <div class="navbar-logo col-md-3 col-sm-12 col-xs-12">
                <a href="#"><img
                            src="{{ asset('img/theme_logo_red.png') }}"
                            title="Tootiye" alt="Tootiye"></a>
            </div>
            <!-- //end Logo -->

            <!-- Search -->
            <div class="search-res col-md-5 col-sm-12 col-xs-12">
                <div id="sosearchpro" class="sosearchpro-wrapper so-search search-pro collapsed-block">
                    <h5 class="tabBlockTitle dropdow-search visible-sm visible-xs"><a class="expander "
                                                                                      href="#TabBlock-search">Search&nbsp;<i
                                    class="fa fa-angle-down"></i></a></h5>
                    <div class="tabBlock" id="TabBlock-search">


                        <!-- *** FORMULAIRE DE RECHERCHE ***
_________________________________________________________ -->
                        {{ render(controller("ecommerceArticleBundle:Article:searchForm")) }}
                        <!-- *** FORMULAIRE DE RECHERCHE FIN *** -->


                    </div>
                </div>
                {#<script type="text/javascript">
                    // Autocomplete */
                    (function ($) {
                        $.fn.Soautocomplete = function (option) {
                            return this.each(function () {
                                this.timer = null;
                                this.items = new Array();

                                $.extend(this, option);

                                $(this).attr('autocomplete', 'off');

                                // Focus
                                $(this).on('focus', function () {
                                    this.request();
                                });

                                // Blur
                                $(this).on('blur', function () {
                                    setTimeout(function (object) {
                                        object.hide();
                                    }, 200, this);
                                });

                                // Keydown
                                $(this).on('keydown', function (event) {
                                    switch (event.keyCode) {
                                        case 27: // escape
                                            this.hide();
                                            break;
                                        default:
                                            this.request();
                                            break;
                                    }
                                });

                                // Click
                                this.click = function (event) {
                                    event.preventDefault();

                                    value = $(event.target).parent().attr('data-value');

                                    if (value && this.items[value]) {
                                        this.select(this.items[value]);
                                    }
                                }

                                // Show
                                this.show = function () {
                                    var pos = $(this).position();

                                    $(this).siblings('ul.dropdown-menu').css({
                                        top: pos.top + $(this).outerHeight(),
                                        left: pos.left
                                    });

                                    $(this).siblings('ul.dropdown-menu').show();
                                }

                                // Hide
                                this.hide = function () {
                                    $(this).siblings('ul.dropdown-menu').hide();
                                }

                                // Request
                                this.request = function () {
                                    clearTimeout(this.timer);

                                    this.timer = setTimeout(function (object) {
                                        object.source($(object).val(), $.proxy(object.response, object));
                                    }, 200, this);
                                }

                                // Response
                                this.response = function (json) {
                                    html = '';

                                    if (json.length) {
                                        for (i = 0; i < json.length; i++) {
                                            this.items[json[i]['value']] = json[i];
                                        }

                                        for (i = 0; i < json.length; i++) {
                                            if (!json[i]['category']) {
                                                html += '<li class="media" data-value="' + json[i]['value'] + '">';
                                                if (json[i]['image'] && json[i]['show_image'] && json[i]['show_image'] == 1) {
                                                    html += '	<a class="media-left" href="' + json[i]['link'] + '"><img class="pull-left" src="' + json[i]['image'] + '"></a>';
                                                }

                                                html += '<div class="media-body">';
                                                html += '<h3 class="title"><a href="' + json[i]['link'] + '"><span>' + json[i]['label'] + '</span></a></h3>';
                                                if (json[i]['price'] && json[i]['show_price'] && json[i]['show_price'] == 1) {
                                                    html += '	<div class="price">';
                                                    if (!json[i]['special']) {
                                                        html += '<span class="price">Price : ' + json[i]['price'] + '</span>';
                                                        ;
                                                    } else {
                                                        html += '<span class="price-old">' + json[i]['price'] + '</span><span class="price-new">' + json[i]['special'] + '</span>';
                                                    }
                                                    if (json[i]['tax']) {
                                                        html += '<br />';
                                                        html += '<span class="price-tax">Tax : ' + json[i]['tax'] + '</span>';
                                                    }
                                                    html += '	</div>';
                                                }

                                                if (json[i]['show_addtocart'] || json[i]['show_addtowishlist'] || json[i]['show_addtocompare']) {
                                                    html += '<div class="button-group">';
                                                    if (json[i]['show_addtocart'])
                                                        html += '<button type="button" onclick="cart.add(' + json[i]['value'] + ',' + json[i]['minimum'] + ');"><span class="hidden-xs hidden-sm hidden-md">Add to Cart</span> <i class="fa fa-shopping-cart"></i></button>';
                                                    if (json[i]['show_addtowishlist'])
                                                        html += '<button type="button" data-toggle="tooltip" title="Add to Wish List" onclick="wishlist.add(' + json[i]['value'] + ');"><i class="fa fa-heart"></i></button>';
                                                    if (json[i]['show_addtocompare'])
                                                        html += '<button type="button" data-toggle="tooltip" title="Add to Compare" onclick="compare.add(' + json[i]['value'] + ');"><i class="fa fa-exchange"></i></button>';
                                                    html += '</div>';
                                                }
                                                html += '</div></li>';
                                                html += '<li class="clearfix"></li>';
                                            }
                                        }

                                        // Get all the ones with a categories
                                        var category = new Array();

                                        for (i = 0; i < json.length; i++) {
                                            if (json[i]['category']) {
                                                if (!category[json[i]['category']]) {
                                                    category[json[i]['category']] = new Array();
                                                    category[json[i]['category']]['name'] = json[i]['category'];
                                                    category[json[i]['category']]['item'] = new Array();
                                                }

                                                category[json[i]['category']]['item'].push(json[i]);
                                            }
                                        }

                                        for (i in category) {
                                            html += '<li class="dropdown-header">' + category[i]['name'] + '</li>';

                                            for (j = 0; j < category[i]['item'].length; j++) {
                                                html += '<li data-value="' + category[i]['item'][j]['value'] + '"><a href="#">&nbsp;&nbsp;&nbsp;' + category[i]['item'][j]['label'] + '</a></li>';
                                            }
                                        }
                                    }

                                    if (html) {
                                        this.show();
                                    } else {
                                        this.hide();
                                    }

                                    $(this).siblings('ul.dropdown-menu').html(html);
                                }

                                $(this).after('<ul class="dropdown-menu"></ul>');

                            });
                        }
                    })(window.jQuery);

                    $(document).ready(function () {
                        var selector = '#search0';
                        var total = 0;
                        var showimage = 1;
                        var showprice = 1;
                        var character = 1;
                        var height = 100;
                        var width = 100;


                        $(selector).find('input[name=\'search\']').Soautocomplete({
                            delay: 500,
                            source: function (request, response) {
                                var category_id = $(".select_category select[name=\"category_id\"]").first().val();
                                if (typeof(category_id) == 'undefined')
                                    category_id = 0;
                                var limit = 10;
                                if (request.length >= character) {
                                    $.ajax({
                                        url: 'index.php?route=module/so_searchpro/autocomplete&filter_category_id=' + category_id + '&limit=' + limit + '&width=' + width + '&height=' + height + '&filter_name=' + encodeURIComponent(request),
                                        dataType: 'json',
                                        success: function (json) {
                                            response($.map(json, function (item) {
                                                total = 0;
                                                if (item.total) {
                                                    total = item.total;
                                                }

                                                return {
                                                    price: item.price,
                                                    special: item.special,
                                                    tax: item.tax,
                                                    label: item.name,
                                                    image: item.image,
                                                    link: item.link,
                                                    minimum: item.minimum,
                                                    show_price: showprice,
                                                    show_image: showimage,
                                                    value: item.product_id,
                                                }
                                            }));
                                        }
                                    });
                                }
                            },
                        });
                    });

                </script>#}

            </div>
            <!-- //end Search -->

            <!-- Secondary menu -->
            <div class="cart-wishlish-compare pull-right col-md-4 col-sm-12 col-xs-12">
                {#<ul class="wishlish-compare">
                    <li class="wishlist"><i class="fa fa-heart"></i><a
                                href="http://opencart.magentech.com/themes/so_lovefashion/index.php?route=account/wishlist"
                                id="wishlist-total" class="top-link-wishlist" title="My Wishlish (0)"><span>My Wishlish (0)</span></a>
                    </li>
                    <li class="compare"><i class="fa fa-book"></i> <a
                                href="http://opencart.magentech.com/themes/so_lovefashion/index.php?route=product/compare"
                                id="compare-total" class="top-link-compare"
                                title="Compare (0)"><span>Compare (0)</span></a></li>

                </ul>#}
                <!--Cart desktop-->
                <div class="shopping_cart">

                    <div id="cart" class=" btn-group btn-shopping-cart">
                        {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                            <div class="top_cart dropdown-toggle">
                                <h3 class="title-mod"><a
                                            href="{{ path('ecommerce_article_cart_view', {'id': user.getId(), 'username':user.getUsername()}) }}">Mon
                                        Panier</a></h3>
                                <span class="number">{{ user.getCarts().count }}</span>
                                <span class="text"><a
                                            href="{{ path('ecommerce_article_cart_view', {'id': user.getId(), 'username':user.getUsername()}) }}">produit(s)</a></span>
                            </div>
                        {% else %}
                            <div class="top_cart dropdown-toggle">
                                <h3 class="title-mod">Mon Panier</h3>
                                <span class="number">0</span>
                                <span class="text">produit(s)</span>
                            </div>
                        {% endif %}


                    </div>
                </div>
                <!--//cart-->
            </div>
        </div>


    </div>
</section>
<!-- end container for top line of header -->